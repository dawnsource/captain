/*
 jQuery Lazy Scroll Loading Plugin 0.4.1

 http://plugins.jquery.com/jQueryLazyScrollLoading/
 https://code.google.com/p/jquerylazyscrollloading/

 Apache License 2.0 - http://www.apache.org/licenses/LICENSE-2.0

 @author Dreamltf
 @date 2013/05/14

 Depends: jquery.js (1.2+)
*/
(function(k){function t(b,d){var a=b.getLazyScrollLoadingCachedLazyItems(),g=b.getLazyScrollLoadingViewport(),e=g.getScrollBindTarget(),f=!1,c=null;e.bind("scroll."+h,function(e){0>=d.delay?n(e,b,d,a):f||(f=!0,null!=c&&clearTimeout(c),c=setTimeout(function(){n(e,b,d,a);clearTimeout(c);f=!1},d.delay))});(0>=g.getScrollTop()&&0>=g.getScrollLeft()||p&&9>u)&&e.trigger("scroll."+h)}function n(b,d,a,g){var e=[],f=[];if(a.lazyItemSelector&&((a.isDefaultLazyImageMode||a.onLazyItemFirstVisible||a.onLazyItemVisible)&&
g.each(function(){var a=k(this);a.isLazyScrollLoadingLazyItemVisible(d)&&(e.push(this),a.isLazyScrollLoadingLazyItemLoaded()||(a.data("isLoaded."+h,!0),f.push(this)))}),a.isDefaultLazyImageMode))for(var c=0,l=f.length;c<l;c++){var q=f[c];q.src=q.getAttribute(r)}v(b,d,a,g,e,f)}function v(b,d,a,g,e,f){var c=d[0];a.onScroll&&a.onScroll.apply(c,[b]);if(a.onScrollVertically||a.onScrollUp||a.onScrollDown||a.onScrollToTop||a.onScrollToBottom||a.onScrollHorizontally||a.onScrollLeft||a.onScrollRight||a.onScrollToLeftmost||
a.onScrollToRightmost){var l=d.getLazyScrollLoadingViewport(),k=l.getScrollTop(),n=l.getScrollLeft(),p={scrollTop:k,scrollLeft:n},m=[b,g];l.isVerticalScrollBarScrolling()&&(a.onScrollVertically&&a.onScrollVertically.apply(c,m),a.onScrollUp&&l.isScrollUp()&&a.onScrollUp.apply(c,m),a.onScrollDown&&l.isScrollDown()&&a.onScrollDown.apply(c,m),a.onScrollToTop&&l.isScrollToTop()&&a.onScrollToTop.apply(c,m),a.onScrollToBottom&&l.isScrollToBottom()&&a.onScrollToBottom.apply(c,m));l.isHorizontalScrollBarScrolling()&&
(a.onScrollHorizontally&&a.onScrollHorizontally.apply(c,m),a.onScrollLeft&&l.isScrollLeft()&&a.onScrollLeft.apply(c,m),a.onScrollRight&&l.isScrollRight()&&a.onScrollRight.apply(c,m),a.onScrollToLeftmost&&l.isScrollToLeftmost()&&a.onScrollToLeftmost.apply(c,m),a.onScrollToRightmost&&l.isScrollToRightmost()&&a.onScrollToRightmost.apply(c,m));d.scrollTop(k);d.scrollLeft(n);d.data("scrollHistory."+h,p)}a.onLazyItemVisible&&0<e.length&&a.onLazyItemVisible.apply(c,[b,g,d.pushStack(e)]);a.onLazyItemFirstVisible&&
0<f.length&&a.onLazyItemFirstVisible.apply(c,[b,g,d.pushStack(f)])}var h="LazyScrollLoading",r="lazy-img",w={isDefaultLazyImageMode:!1,lazyItemSelector:null,delay:500,onCreate:null,onScroll:null,onLazyItemFirstVisible:null,onLazyItemVisible:null,onScrollVertically:null,onScrollHorizontally:null,onScrollUp:null,onScrollDown:null,onScrollLeft:null,onScrollRight:null,onScrollToTop:null,onScrollToBottom:null,onScrollToLeftmost:null,onScrollToRightmost:null},s=navigator.userAgent.toLowerCase(),p=/msie/.test(s),
u=p?parseFloat((s.match(/.*(?:rv|ie)[\/: ](.+?)([ \);]|$)/)||[])[1]):-1;k.extend(k.fn,{lazyScrollLoading:function(b){b=k.extend({},w,b);b.isDefaultLazyImageMode&&!b.lazyItemSelector&&(b.lazyItemSelector="img["+r+"]:not([src])");return this.each(function(){var d=k(this);d.destroyLazyScrollLoading();d.data("options."+h,b);t(d,b);b.onCreate&&b.onCreate.apply(d[0])})},getLazyScrollLoadingOptions:function(){return this.data("options."+h)},getLazyScrollLoadingScrollHistory:function(){return this.data("scrollHistory."+
h)},getLazyScrollLoadingViewport:function(){var b=this,d=b[0],a=k(window),g=k(document),e=d==window||d==document||d==document.body,f=b.offset(),c=b.getLazyScrollLoadingScrollHistory();return{getScrollLeft:function(){return(e?a:b).scrollLeft()},getScrollTop:function(){return(e?a:b).scrollTop()},getScrollBindTarget:function(){return e?g:b},getWidth:function(c){return e?a.width():c?b.outerWidth():b.innerWidth()},getHeight:function(c){return e?a.height():c?b.outerHeight():b.innerHeight()},getScrollWidth:function(){return e?
g.width():d.scrollWidth},getScrollHeight:function(){return e?g.height():d.scrollHeight},getLeftPos:function(){return e?this.getScrollLeft():f.left},getTopPos:function(){return e?this.getScrollTop():f.top},getRightPos:function(){return this.getLeftPos()+this.getWidth(!0)},getBottomPos:function(){return this.getTopPos()+this.getHeight(!0)},isVerticalScrollBarVisible:function(){return this.getHeight(!1)<this.getScrollHeight()},isHorizontalScrollBarVisible:function(){return this.getWidth(!1)<this.getScrollWidth()},
isVerticalScrollBarScrolling:function(){return!this.isVerticalScrollBarVisible()?!1:!c||c.scrollTop!=this.getScrollTop()},isHorizontalScrollBarScrolling:function(){return!this.isHorizontalScrollBarVisible()?!1:!c||c.scrollLeft!=this.getScrollLeft()},isScrollUp:function(){return!this.isVerticalScrollBarVisible()?!1:!c||c.scrollTop>this.getScrollTop()},isScrollDown:function(){return!this.isVerticalScrollBarVisible()?!1:!c||c.scrollTop<this.getScrollTop()},isScrollLeft:function(){return!this.isHorizontalScrollBarVisible()?
!1:!c||c.scrollLeft>this.getScrollLeft()},isScrollRight:function(){return!this.isHorizontalScrollBarVisible()?!1:!c||c.scrollLeft<this.getScrollLeft()},isScrollToTop:function(){return!this.isVerticalScrollBarVisible()?!1:0>=this.getScrollTop()},isScrollToBottom:function(){return!this.isVerticalScrollBarVisible()?!1:this.getScrollTop()>=this.getScrollHeight()-this.getHeight(!1)},isScrollToLeftmost:function(){return!this.isHorizontalScrollBarVisible()?!1:0>=this.getScrollLeft()},isScrollToRightmost:function(){return!this.isHorizontalScrollBarVisible()?
!1:this.getScrollLeft()>=this.getScrollWidth()-this.getWidth(!1)}}},getLazyScrollLoadingCachedLazyItems:function(b,d){return this.pushStack(k.map(this,function(a){var g=k(a),e=g.getLazyScrollLoadingOptions(),f=g.data("items."+h);if(e&&e.lazyItemSelector&&(b||!f))f=k(e.lazyItemSelector,a==window||a==document||a==document.body?void 0:g),g.data("items."+h,f);f&&d&&(f=f.filter(d));return null!=f?f.get():null}))},destroyLazyScrollLoading:function(){return this.each(function(){var b=k(this);b.getLazyScrollLoadingViewport().getScrollBindTarget().unbind("scroll."+
h);b.getLazyScrollLoadingCachedLazyItems().removeData("isLoaded."+h);b.removeData("items."+h).removeData("scrollHistory."+h).removeData("options."+h)})},isLazyScrollLoadingLazyItemLoaded:function(){return!0===this.data("isLoaded."+h)},isLazyScrollLoadingLazyItemVisible:function(b){var d=this.getLazyScrollLoadingViewport();b=b.getLazyScrollLoadingViewport();return d.getBottomPos()>b.getTopPos()&&d.getLeftPos()<b.getRightPos()&&d.getTopPos()<b.getBottomPos()&&d.getRightPos()>b.getLeftPos()}})})(jQuery);
